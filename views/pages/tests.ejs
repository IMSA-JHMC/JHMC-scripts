<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('../partials/head'); %>
</head>

<body class="container">

    <header>
        <%- include('../partials/header'); %>
    </header>

    <main>
        <div class="row">
            <div class="col-sm-12">
                <div class="jumbotron">
                    <h1>
                        <%= competition %> Test
                    </h1>
                    <p>You have <%= duration %> to complete this test</p>
                    <button type="button" id="beginTestButton" class="btn btn-dark btn-lg">Begin Test</button>
                    <div id="loadingSpinner" class="spinner-border" style="width: 2rem; height: 2rem;display: none;"
                        role="status">
                        <span class="sr-only">Loading...</span>
                    </div>
                    <div id="questionDiv" style="display:none;">
                        <hr>
                        <form>
                            <h2 id='questionTitle'>Question 1</h2>
                            <h5 id='questionHelp'>Question Text LaTeX</h5>
                            <div class="input-group mb-3">
                                <input type="text" class="form-control" placeholder="Your Answer"
                                    aria-label="Recipient's username" aria-describedby="button-addon2">
                                <button class="btn btn-outline-dark" type="button" id="button-addon2">Next â†’</button>
                            </div>
                            <div id="answerHelp" class="form-text" style="display:block;">Answer must be exact. Do not round.</div>
                            
                        </form>
                    </div>
                </div>
                <div class="progress">
                    <div class="progress-bar w-75" role="progressbar" aria-valuenow="75" aria-valuemin="0"
                        aria-valuemax="100"></div>
                </div>
                <br>
            </div>

            <!-- <div class="col-sm-3">
                <div class="well">
                    <h3>Time Remaining</h3>
                </div>
            </div> -->

        </div>
    </main>

    <footer>
        <%- include('../partials/footer'); %>
    </footer>
    <script>
        var recordId = '<%- recordId %>';
        var competitionId = '<%- competitionId %>';
        var competitionCode = '<%- competitionCode %>';

        $(document).ready(() => {
            $("#beginTestButton").click(() => {
                $("#beginTestButton").hide();
                loading();
                // $("#beginTestButton").html('<div class="spinner-border spinner-border-sm" role="status"><span class="sr-only">Loading...</span></div>')
                $.post("/test/endpoint/" + recordId + "?action=begin&competitionCode=" + competitionCode, (data) => {
                    console.log(data);
                    loading(false);
                    $("#questionDiv").show();
                });

                //TODO: Toast with 5 minutes remaining
            });

            var loading = (go) => {
                if (go === false) {
                    $("#loadingSpinner").hide();
                } else {
                    $("#loadingSpinner").show();
                }
            }

        })
    </script>
</body>

</html>